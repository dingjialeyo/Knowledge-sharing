<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        *{
            margin: 0;
            padding: 0;
        }
        img {
            position: absolute;
        }
    </style>
</head>
<body>
    <img src="../模板/go.gif" alt="" id="img">


    <script>
        function my$(id){
            return document.getElementById(id);
        }


        //谷歌和火狐都有这个事件参数e，IE8没有；
        //IE8的事件参数用window.event来代替e。
        // document.onmousemove = function(e){
        //     // console.log(arguments[0])       //arguments.length这个事件的参数长度
        //     // console.log(e);
        //     document.title = e.clientX+"==========>"+e.clientY;
        //     my$("img").style.left = e.clientX+"px";
        //     my$("img").style.top = e.clientY+"px"
        // }

        //IE8写法
        // document.onmousemove = function(){
        //     // console.log(arguments[0])       //arguments.length这个事件的参数长度
        //     // console.log(e);
        //     // document.title = e.clientX+"==========>"+e.clientY;
        //     my$("img").style.left = window.event.clientX+"px";
        //     my$("img").style.top = window.event.clientY+"px"
        // }
        
        //兼容
        // document.onmousemove = function(e){
        //     e = window.event || e;
        //     my$("img").style.left = e.clientX+"px";      //clientX和clientY    是绝对可视区域的横纵坐标
        //     my$("img").style.top = e.clientY+"px"
        // }

        // document.onmousemove = function(e){
        //     e = window.event || e;
        //     my$("img").style.left = e.pageX+"px";      //pageX和pageY    是相对可视区域的横纵坐标但是IE8不支持将e改为window.event
        //     my$("img").style.top = e.pageY+"px"
        // }



        // //简单对象函数
        // var Obj = {
        //     hi : function () {  
        //     console.log("a");
        //     this.no();
        // },
        //     no : function(){
        //     console.log("bbb")
        // }
        // }
        // Obj.hi();

        // var evt = {
        //     //window.event和事件参数对象e的兼容
        //     getEvent : function (e){
        //         return window.event || e;
        //     }
        // }
        // document,onmousemove = function(e){
        //     my$("img").style.left = getEvent(e).clientX+"px";
        //     my$("img").style.top = getEvent(e).clientY+"px"
        // }


        //写获取样式的一个属性的兼容
        function getStyle(ele, attr) {
            if (window.getComputedStyle) {
                return window.getComputedStyle(ele, null)[attr]; //xxx.left  ==  xxx["left"]
            } else {
                return ele.currentStyle[attr];
            }
        };

        function animate(ele, json,fn) { //目标元素，样式，目标位置
            //清理定时器
            clearInterval(ele.timeId);
            ele.timeId = setInterval(function () {
                var flag = true;
                for (var attr in json) {
                    //判断是否有这个zIndex属性
                    if(attr == "zIndex"){
                        //层级改变只需要改变这个值
                        ele.style[attr] = json[attr];
                    }
                    //判断是否有这个opacity属性
                    else if(attr == "opacity"){
                    //获取当前元素的透明度
                    var current = getStyle(ele, attr)*100;  //将透明度增加100倍好计算     并且getStyle(ele, attr)是数字类型
                    //当前的属性对应的值
                    var target = json[attr]*100;
                    //移动的步数
                    var step = (target - current) / 10; //json[attr]就是这个属性的值
                    //判断step是否为正数为正向上取整,负数是向下取整。
                    step = step > 0 ? Math.ceil(step) : Math.floor(step);
                    current += step;
                    ele.style[attr] = current/100;    //计算完后还原回去
                    }
                    //普通的带px的属性
                    else{
                    //获取当前元素位置
                    var current = parseInt(getStyle(ele, attr)) //转数字类型
                    //当前的属性对应的值
                    var target = json[attr];
                    //移动的步数
                    var step = (target - current) / 10; //json[attr]就是这个属性的值
                    //判断step是否为正数为正向上取整,负数是向下取整。
                    step = step > 0 ? Math.ceil(step) : Math.floor(step);
                    current += step;
                    ele.style[attr] = current + "px";
                    }
                    // 判断是否到达目标
                    if (current != target) {
                        flag = false;
                    }
                }
            if (flag) {
                clearInterval(ele.timeId);   //所有属性准备完了才清理定时器
                //然后触发回调函数，前提用户传入了这个函数
                if(fn){
                    fn();
                }
            };
        }, 20)
    };
        //鼠标按下事件
        document.onmousedown = function (e) {
            var x= e.clientX;
            var y= e.clientY;
            animate(my$("img"),{left:x,top:y})
        }
    </script>
</body>
</html>